@PART[chemical-storage-tank-*]:AFTER[ChemicalStorage]
{
	chemTechTankVolumePropellant = #$MODULE[ModuleB9PartSwitch]:HAS[#moduleID[fuelSwitch]]/baseVolume$
	@chemTechTankVolumePropellant *= 5
	-MODULE[ModuleB9PartSwitch]:HAS[#moduleID[fuelSwitch]] {}

	@MODULE[ModuleB9PartSwitch]:HAS[#moduleID[lengthSwitch]]
	{
		-parentID = _
		@SUBTYPE:HAS[#volumeAddedToParent],*
		{
			MODULE
			{
				IDENTIFIER
				{
					name = ModuleIgnitionTankController
					moduleID = chemTechPropellant
				}
				DATA
				{
					volume = #$../../volumeAddedToParent$
					@volume *= 5
					@volume += #$../../../../chemTechTankVolumePropellant$
				}
			}
		}
	}
}

// Basic
@PART[chemical-storage-tank-*-basic]:AFTER[ChemicalStorage]
{
	chemTechTankType = storable
}

// Cryogenic
@PART[chemical-storage-tank-*-cryo-*]:AFTER[ChemicalStorage]
{
	chemTechTankType = cryogenic
}

// Remove part upgrade restriction on first subtype
@PART[chemical-storage-tank-*]:FOR[zzz_ChemicalPropulsion]
{
    @MODULE[ModuleB9PartSwitch]:HAS[#moduleID[chemTechPropellantSwitch]]
	{
		@SUBTYPE,0
		{
			-upgradeRequired = _
		}
	}
}