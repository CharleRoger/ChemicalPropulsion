// Straightforward parts
@PART[USAdvancedMicroSatWedge]:NEEDS[UniversalStorage2]
{
	@MODULE[ModuleEngines*]:HAS[#engineID[LiquidFuel]]
	{
		-PROPELLANT,* {}
		PROPELLANT
		{
			name = Hydrazine
			ratio = 7
			DrawGauge = True
		}
		PROPELLANT
		{
			name = NTO
			ratio = 9
		}
	}
	@MODULE[ModuleEngines*]:HAS[#engineID[MonoPropellant]]
	{
		-PROPELLANT,* {}
		PROPELLANT
		{
			name = Hydrazine
			ratio = 1
			DrawGauge = True
		}
	}
	@MODULE[USFuelSwitch]
	{
		chemTechUSFuelSwitch = true
		@resourceNames = Hydrazine,NTO;Hydrazine;XenonGas
		@resourceAmounts = 10.5,13.5;24;220.202
		@initialResourceAmounts = #$resourceAmounts$
	}
	@MODULE[USSwitchControl]
	{
		chemTechUSSwitchControl = true
		@ObjectNames = #LOC_ChemicalPropulsion_propellant_Hydrazine_NTO_title;#LOC_ChemicalCore_Hydrazine_title;#LOC_ChemicalCore_XenonGas_title
		@VariantColors = #$@ChemicalCoreResourceColors/Hydrazine$,$@ChemicalCoreResourceColors/NTO$;$@ChemicalCoreResourceColors/Hydrazine$,$@ChemicalCoreResourceColors/Hydrazine$;#3a562a,#999999
	}
}
@PART[USRadialTanks]:NEEDS[UniversalStorage2]:FOR[zzz_ChemicalPropulsion]
{
	@MODULE[USFuelSwitch]:HAS[#SwitchID[0]]
	{
		chemTechUSFuelSwitch = true
		@resourceNames = Kerosene,LqdOxygen;LqdHydrogen,LqdOxygen;Hydrazine,NTO;Kerosene;HTP;Hydrazine;LqdHydrogen;LqdOxygen;NTO;TEATEB
		@resourceAmounts = 6,10;12,4;7,9;16;16;16;16;16;16;16
		@initialResourceAmounts = #$resourceAmounts$
		@tankCost = 0;0;0;0;0;0;0;0;0;0
		@tankMass = 0.015;0.015;0.015;0.015;0.015;0.015;0.015;0.015;0.015;0.015
	}
	@MODULE[USMeshSwitch]:HAS[#SwitchID[0]]
	{
		chemTechUSMeshSwitch = true
		@MeshTransforms = RadialSmallLiquidFuel;RadialSmallLiquidFuel;RadialSmallLiquidFuel;RadialSmallLiquidFuel;RadialSmallMonoprop;RadialSmallMonoprop;RadialSmallHydrogen;RadialSmallOxygen;RadialSmallOxygen;RadialSmallLiquidFuel
	}
	@MODULE[USSwitchControl]:HAS[#SwitchID[0]]
	{
		chemTechUSSwitchControl = true
		@ObjectNames = 
		@VariantColors = 
	}
}

// Parts with volume scaling

// Set part-specific baseline parameters and mesh transforms and add chemTech tags to patched modules
@PART[USAerozineWedge]:NEEDS[UniversalStorage2]:BEFORE[zzz_ChemicalPropulsion]
{
	@MODULE[USFuelSwitch]:HAS[#SwitchID[0;1]]
	{
		chemTechUSFuelSwitch = true
		@SwitchID = 0;1
		chemTechUSVolume1 = 60
		chemTechUSCost1 = 0
		chemTechUSMass1 = 0
		chemTechUSVolume2 = 120
		chemTechUSCost2 = 35
		chemTechUSMass2 = 0.014
	}
	@MODULE[USSwitchControl]:HAS[#SwitchID[1]]
	{
		chemTechUSSwitchControl = true
	}
}
@PART[USHydrazineWedge]:NEEDS[UniversalStorage2]:BEFORE[zzz_ChemicalPropulsion]
{
	chemTechTankType = monopropellant
	@MODULE[USFuelSwitch]:HAS[#SwitchID[0]]
	{
		chemTechUSFuelSwitch = true
		@SwitchID = 0;1
		chemTechUSVolume1 = 40
		chemTechUSCost1 = 0
		chemTechUSMass1 = 0
		chemTechUSVolume2 = 80
		chemTechUSCost2 = 53
		chemTechUSMass2 = 0.007
	}
	MODULE
	{
		chemTechUSSwitchControl = true
		name = USSwitchControl
		SwitchID = 1
		ButtonName = Propellant Variants
		CurrentVariantTitle = Propellant Variants
		ShowPreviousButton = False
		FuelSwitchModeTwo = True
		ModuleDisplayName = Tank Options
	}
}
@PART[USPenticore]:NEEDS[UniversalStorage2]:BEFORE[zzz_ChemicalPropulsion]
{
	@MODULE[USFuelSwitch]:HAS[#SwitchID[0;1]]
	{
		chemTechUSFuelSwitch = true
		chemTechUSVolume1 = 50
		chemTechUSCost1 = 5
		chemTechUSMass1 = 0.008
		chemTechUSVolume2 = 100
		chemTechUSCost2 = 59
		chemTechUSMass2 = 0.047
	}
	@MODULE[USMeshSwitch]:HAS[#SwitchID[1]]
	{
		chemTechUSMeshSwitch = true
		@MeshTransforms = Penti1H,Penti2H,Penti3H,Penti4H;Penti1D,Penti2D,Penti3D,Penti4D;Penti1D,Penti2D,Penti3D,Penti4D;Penti1M,Penti2M,Penti3M,Penti4M;Penti1D,Penti2D,Penti3D,Penti4D;Penti1M,Penti2M,Penti3M,Penti4M;Penti1M,Penti2M,Penti3M,Penti4M;Penti1D,Penti2D,Penti3D,Penti4D;Penti1D,Penti2D,Penti3D,Penti4D;Penti1D,Penti2D,Penti3D,Penti4D;Penti1X,Penti2X,Penti3X,Penti4X
	}
	@MODULE[USSwitchControl]:HAS[#SwitchID[1]]
	{
		chemTechUSSwitchControl = true
	}
}
@PART[USHexcore]:NEEDS[UniversalStorage2]:BEFORE[zzz_ChemicalPropulsion]
{
	@MODULE[USFuelSwitch]:HAS[#SwitchID[0;1]]
	{
		chemTechUSFuelSwitch = true
		chemTechUSVolume1 = 200
		chemTechUSCost1 = 19
		chemTechUSMass1 = 0.033
		chemTechUSVolume2 = 400
		chemTechUSCost2 = 249
		chemTechUSMass2 = 0.186
	}
	@MODULE[USMeshSwitch]:HAS[#SwitchID[1]]
	{
		chemTechUSMeshSwitch = true
		@MeshTransforms = Hex1H,Hex2H,Hex3H,Hex4H;Hex1D,Hex2D,Hex3D,Hex4D;Hex1D,Hex2D,Hex3D,Hex4D;Hex1M,Hex2M,Hex3M,Hex4M;Hex1D,Hex2D,Hex3D,Hex4D;Hex1M,Hex2M,Hex3M,Hex4M;Hex1M,Hex2M,Hex3M,Hex4M;Hex1D,Hex2D,Hex3D,Hex4D;Hex1D,Hex2D,Hex3D,Hex4D;Hex1D,Hex2D,Hex3D,Hex4D;Hex1X,Hex2X,Hex3X,Hex4X
	}
	@MODULE[USSwitchControl]:HAS[#SwitchID[1]]
	{
		chemTechUSSwitchControl = true
	}
}
@PART[USOctocore]:NEEDS[UniversalStorage2]:BEFORE[zzz_ChemicalPropulsion]
{
	@MODULE[USFuelSwitch]:HAS[#SwitchID[0;1]]
	{
		chemTechUSFuelSwitch = true
		chemTechUSVolume1 = 320
		chemTechUSCost1 = 31
		chemTechUSMass1 = 0.056
		chemTechUSVolume2 = 640
		chemTechUSCost2 = 531
		chemTechUSMass2 = 0.504
	}
	@MODULE[USMeshSwitch]:HAS[#SwitchID[1]]
	{
		chemTechUSMeshSwitch = true
		@MeshTransforms = Octo1H,Octo2H,Octo3H,Octo4H;Octo1D,Octo2D,Octo3D,Octo4D;Octo1D,Octo2D,Octo3D,Octo4D;Octo1M,Octo2M,Octo3M,Octo4M;Octo1D,Octo2D,Octo3D,Octo4D;Octo1M,Octo2M,Octo3M,Octo4M;Octo1M,Octo2M,Octo3M,Octo4M;Octo1D,Octo2D,Octo3D,Octo4D;Octo1D,Octo2D,Octo3D,Octo4D;Octo1D,Octo2D,Octo3D,Octo4D;Octo1X,Octo2X,Octo3X,Octo4X
	}
	@MODULE[USSwitchControl]:HAS[#SwitchID[1]]
	{
		chemTechUSSwitchControl = true
	}
}
@PART[USAdaptorShroud1250Soyuz]:NEEDS[UniversalStorage2]:BEFORE[zzz_ChemicalPropulsion]
{
	@MODULE[USFuelSwitch]
	{
		chemTechUSFuelSwitch = true
		chemTechUSVolume1 = 275
		chemTechUSCost1 = 128
		chemTechUSMass1 = 0.032
		chemTechUSVolume2 = 275 // Do not scale tank volume
		chemTechUSCost2 = 256
		chemTechUSMass2 = 0.064
	}
	@MODULE[USMeshSwitch]:HAS[#SwitchID[2]]
	{
		chemTechUSMeshSwitch = true
		@MeshTransforms = SoyuzTorusStructural;SoyuzTorusLF;SoyuzTorusLF;SoyuzTorusMono;SoyuzTorusLF;SoyuzTorusMono;SoyuzTorusMono;SoyuzTorusLF;SoyuzTorusLF;SoyuzTorusLF
	}
	@MODULE[USSwitchControl]:HAS[#SwitchID[2]]
	{
		chemTechUSSwitchControl = true
	}
}
@PART[USAdaptorShroud1250Vostok]:NEEDS[UniversalStorage2]:BEFORE[zzz_ChemicalPropulsion]
{
	@MODULE[USFuelSwitch]:HAS[#SwitchID[0;1]]
	{
		chemTechUSFuelSwitch = true
	}
	@MODULE[USMeshSwitch]:HAS[#SwitchID[1]]
	{
		chemTechUSMeshSwitch = true
		@MeshTransforms = VostokTorusStructural;VostokTorusRadiator;VostokTorusLF;VostokTorusLF;VostokTorusMono;VostokTorusLF;VostokTorusMono;VostokTorusMono;VostokTorusLF;VostokTorusLF;VostokTorusLF
	}
	@MODULE[USNodeSwitch]:HAS[#SwitchID[1]]
	{
		chemTechUSNodeSwitch = true
		@AttachNodes = VostokDummyGroup;VostokRadGroup;VostokDummyGroup;VostokDummyGroup;VostokDummyGroup;VostokDummyGroup;VostokDummyGroup;VostokDummyGroup;VostokDummyGroup;VostokDummyGroup;VostokDummyGroup
	}
	@MODULE[USRadiatorSwitch]:HAS[#SwitchID[1]]
	{
		chemTechUSRadiatorSwitch = true
		@RadiatorPower = 0;5000;0;0;0;0;0;0;0;0;0;0;0;0;0
		RadiatorEnergy = 0;0.05;0;0;0;0;0;0;0;0;0;0;0;0;0
	}
	@MODULE[USSwitchControl]:HAS[#SwitchID[1]]
	{
		chemTechUSSwitchControl = true
		@ObjectNames = Structural;Radiator;
		@VariantColors = #565656,#565656;#eeeeee,#565656;
	}
}
@PART[USCylindricalShroud1500]:NEEDS[UniversalStorage2]:FOR[zzz_ChemicalPropulsion]
{
	@MODULE[USFuelSwitch]:HAS[#SwitchID[0;2]]
	{
		chemTechUSFuelSwitch = true
		chemTechUSVolume1 = 420
		chemTechUSCost1 = 200
		chemTechUSMass1 = 0.05
		chemTechUSVolume2 = 420 // Do not scale tank volume
		chemTechUSCost2 = 280
		chemTechUSMass2 = 0.09
		chemTechUSVolume5 = 2220
		chemTechUSCost5 = 625
		chemTechUSMass5 = 0.18
	}
	@MODULE[USMeshSwitch]:HAS[#SwitchID[2]]
	{
		chemTechUSMeshSwitch = true
		@MeshTransforms = 1500TorusStructural;1500TorusLF;1500TorusLF;1500TorusMono;1500TorusLF;1500TorusMono;1500TorusMono;1500TorusLF;1500TorusLF;1500TorusLF
	}
	@MODULE[USSwitchControl]:HAS[#SwitchID[2]]
	{
		chemTechUSSwitchControl = true
	}
}
@PART[USCylindricalShroud1500ResizedTo1875-2]:NEEDS[UniversalStorage2]:FOR[zzz_ChemicalPropulsion]
{
	-MODULE[USFuelSwitch]:HAS[#SwitchID[0]] {}
	@MODULE[USFuelSwitch]:HAS[#SwitchID[2]]
	{
		chemTechUSFuelSwitch = true
		@SwitchID = 0;2
		@hasGUI = True
		chemTechUSVolume1 = 840
		chemTechUSCost1 = 400
		chemTechUSMass1 = 0.1
		chemTechUSVolume2 = 840 // Do not scale tank volume
		chemTechUSCost2 = 560
		chemTechUSMass2 = 0.18
		chemTechUSVolume5 = 4440
		chemTechUSCost5 = 1250
		chemTechUSMass5 = 0.36
	}
	@MODULE[USMeshSwitch]:HAS[#SwitchID[2]]
	{
		chemTechUSMeshSwitch = true
		@MeshTransforms = 1500TorusStructural;1500TorusLF;1500TorusLF;1500TorusMono;1500TorusLF;1500TorusMono;1500TorusMono;1500TorusLF;1500TorusLF;1500TorusLF
	}
	@MODULE[USSwitchControl]:HAS[#SwitchID[2]]
	{
		chemTechUSSwitchControl = true
		@FuelSwitchModeOne = False
		FuelSwitchModeTwo = True
	}
}

// Compute tank volumes, masses and costs
@PART[USAerozineWedge,USHydrazineWedge,USPenticore,USHexcore,USOctocore,USAdaptorShroud1250Soyuz,USCylindricalShroud1500,USCylindricalShroud1500ResizedTo1875-2]:NEEDS[UniversalStorage2]:FOR[zzz_ChemicalPropulsion]
{
	@MODULE[USFuelSwitch]:HAS[#chemTechUSFuelSwitch[true]]
	{
		chemTechUSVolume1_025 = #$chemTechUSVolume1$
		@chemTechUSVolume1_025 *= 0.25
		chemTechUSVolume1_0375 = #$chemTechUSVolume1$
		@chemTechUSVolume1_0375 *= 0.375
		chemTechUSVolume1_04375 = #$chemTechUSVolume1$
		@chemTechUSVolume1_04375 *= 0.4375
		chemTechUSVolume1_05625 = #$chemTechUSVolume1$
		@chemTechUSVolume1_05625 *= 0.5625
		chemTechUSVolume1_0625 = #$chemTechUSVolume1$
		@chemTechUSVolume1_0625 *= 0.625
		chemTechUSVolume1_075 = #$chemTechUSVolume1$
		@chemTechUSVolume1_075 *= 0.75

		chemTechUSVolume2_025 = #$chemTechUSVolume2$
		@chemTechUSVolume2_025 *= 0.25
		chemTechUSVolume2_0375 = #$chemTechUSVolume2$
		@chemTechUSVolume2_0375 *= 0.375
		chemTechUSVolume2_04375 = #$chemTechUSVolume2$
		@chemTechUSVolume2_04375 *= 0.4375
		chemTechUSVolume2_05625 = #$chemTechUSVolume2$
		@chemTechUSVolume2_05625 *= 0.5625
		chemTechUSVolume2_0625 = #$chemTechUSVolume2$
		@chemTechUSVolume2_0625 *= 0.625
		chemTechUSVolume2_075 = #$chemTechUSVolume2$
		@chemTechUSVolume2_075 *= 0.75

		chemTechUSVolume3 = #$chemTechUSVolume2$
		@chemTechUSVolume3 -= #$chemTechUSVolume1$
		@chemTechUSVolume3 *= 2
		@chemTechUSVolume3 += #$chemTechUSVolume1$
		chemTechUSVolume3_025 = #$chemTechUSVolume3$
		@chemTechUSVolume3_025 *= 0.25
		chemTechUSVolume3_0375 = #$chemTechUSVolume3$
		@chemTechUSVolume3_0375 *= 0.375
		chemTechUSVolume3_04375 = #$chemTechUSVolume3$
		@chemTechUSVolume3_04375 *= 0.4375
		chemTechUSVolume3_05625 = #$chemTechUSVolume3$
		@chemTechUSVolume3_05625 *= 0.5625
		chemTechUSVolume3_0625 = #$chemTechUSVolume3$
		@chemTechUSVolume3_0625 *= 0.625
		chemTechUSVolume3_075 = #$chemTechUSVolume3$
		@chemTechUSVolume3_075 *= 0.75
		chemTechUSCost3 = #$chemTechUSCost2$
		@chemTechUSCost3 -= #$chemTechUSCost1$
		@chemTechUSCost3 *= 2
		@chemTechUSCost3 += #$chemTechUSCost1$
		chemTechUSMass3 = #$chemTechUSMass2$
		@chemTechUSMass3 -= #$chemTechUSMass1$
		@chemTechUSMass3 *= 2
		@chemTechUSMass3 += #$chemTechUSMass1$

		chemTechUSVolume4 = #$chemTechUSVolume2$
		@chemTechUSVolume4 -= #$chemTechUSVolume1$
		@chemTechUSVolume4 *= 3
		@chemTechUSVolume4 += #$chemTechUSVolume1$
		chemTechUSVolume4_025 = #$chemTechUSVolume4$
		@chemTechUSVolume4_025 *= 0.25
		chemTechUSVolume4_0375 = #$chemTechUSVolume4$
		@chemTechUSVolume4_0375 *= 0.375
		chemTechUSVolume4_04375 = #$chemTechUSVolume4$
		@chemTechUSVolume4_04375 *= 0.4375
		chemTechUSVolume4_05625 = #$chemTechUSVolume4$
		@chemTechUSVolume4_05625 *= 0.5625
		chemTechUSVolume4_0625 = #$chemTechUSVolume4$
		@chemTechUSVolume4_0625 *= 0.625
		chemTechUSVolume4_075 = #$chemTechUSVolume4$
		@chemTechUSVolume4_075 *= 0.75
		chemTechUSCost4 = #$chemTechUSCost2$
		@chemTechUSCost4 -= #$chemTechUSCost1$
		@chemTechUSCost4 *= 3
		@chemTechUSCost4 += #$chemTechUSCost1$
		chemTechUSMass4 = #$chemTechUSMass2$
		@chemTechUSMass4 -= #$chemTechUSMass1$
		@chemTechUSMass4 *= 3
		@chemTechUSMass4 += #$chemTechUSMass1$
		
		%resourceAmounts = #$chemTechUSVolume1$;$chemTechUSVolume2$;$chemTechUSVolume3$;$chemTechUSVolume4$
		%resourceAmountsKeroseneLqdOxygen = #$chemTechUSVolume1_0375$,$chemTechUSVolume1_0625$;$chemTechUSVolume2_0375$,$chemTechUSVolume2_0625$;$chemTechUSVolume3_0375$,$chemTechUSVolume3_0625$;$chemTechUSVolume4_0375$,$chemTechUSVolume4_0625$
		%resourceAmountsLqdHydrogenLqdOxygen = #$chemTechUSVolume1_075$,$chemTechUSVolume1_025$;$chemTechUSVolume2_075$,$chemTechUSVolume2_025$;$chemTechUSVolume3_075$,$chemTechUSVolume3_025$;$chemTechUSVolume4_075$,$chemTechUSVolume4_025$
		%resourceAmountsHydrazineNTO = #$chemTechUSVolume1_04375$,$chemTechUSVolume1_05625$;$chemTechUSVolume2_04375$,$chemTechUSVolume2_05625$;$chemTechUSVolume3_04375$,$chemTechUSVolume3_05625$;$chemTechUSVolume4_04375$,$chemTechUSVolume4_05625$
		%tankCost = #$chemTechUSCost1$;$chemTechUSCost2$;$chemTechUSCost3$;$chemTechUSCost4$
		%tankMass = #$chemTechUSMass1$;$chemTechUSMass2$;$chemTechUSMass3$;$chemTechUSMass4$
	}
}
@PART[USCylindricalShroud1500,USCylindricalShroud1500ResizedTo1875-2]:NEEDS[UniversalStorage2]:FOR[zzz_ChemicalPropulsion]
{
	@MODULE[USFuelSwitch]:HAS[#chemTechUSFuelSwitch[true]]
	{
		chemTechUSVolume5_025 = #$chemTechUSVolume5$
		@chemTechUSVolume5_025 *= 0.25
		chemTechUSVolume5_0375 = #$chemTechUSVolume5$
		@chemTechUSVolume5_0375 *= 0.375
		chemTechUSVolume5_04375 = #$chemTechUSVolume5$
		@chemTechUSVolume5_04375 *= 0.4375
		chemTechUSVolume5_05625 = #$chemTechUSVolume5$
		@chemTechUSVolume5_05625 *= 0.5625
		chemTechUSVolume5_0625 = #$chemTechUSVolume5$
		@chemTechUSVolume5_0625 *= 0.625
		chemTechUSVolume5_075 = #$chemTechUSVolume5$
		@chemTechUSVolume5_075 *= 0.75


		@resourceAmounts = #$resourceAmounts$;$chemTechUSVolume5$
		@resourceAmountsKeroseneLqdOxygen = #$resourceAmountsKeroseneLqdOxygen$;$chemTechUSVolume1_0375$,$chemTechUSVolume1_0625$
		@resourceAmountsLqdHydrogenLqdOxygen = #$resourceAmountsLqdHydrogenLqdOxygen$;$chemTechUSVolume1_075$,$chemTechUSVolume1_025$
		@resourceAmountsHydrazineNTO = #$resourceAmountsHydrazineNTO$;$chemTechUSVolume1_04375$,$chemTechUSVolume1_05625$
		@tankCost = #$tankCost$;$chemTechUSCost5$
		@tankMass = #$tankMass$;$chemTechUSMass5$
	}
}

// Set part-specific parameters
@PART[USAerozineWedge]:NEEDS[UniversalStorage2]:FOR[zzz_ChemicalPropulsion]
{
	@MODULE[USFuelSwitch]:HAS[#chemTechUSFuelSwitch[true]]
	{
		@resourceNames = Kerosene,LqdOxygen;Kerosene,LqdOxygen;Kerosene,LqdOxygen;Kerosene,LqdOxygen|LqdHydrogen,LqdOxygen;LqdHydrogen,LqdOxygen;LqdHydrogen,LqdOxygen;LqdHydrogen,LqdOxygen|Hydrazine,NTO;Hydrazine,NTO;Hydrazine,NTO;Hydrazine,NTO|Kerosene;Kerosene;Kerosene;Kerosene|HTP;HTP;HTP;HTP|Hydrazine;Hydrazine;Hydrazine;Hydrazine|LqdHydrogen;LqdHydrogen;LqdHydrogen;LqdHydrogen|LqdOxygen;LqdOxygen;LqdOxygen;LqdOxygen|NTO;NTO;NTO;NTO
		@resourceAmounts = #$resourceAmountsKeroseneLqdOxygen$|$resourceAmountsLqdHydrogenLqdOxygen$|$resourceAmountsHydrazineNTO$|$resourceAmounts$|$resourceAmounts$|$resourceAmounts$|$resourceAmounts$|$resourceAmounts$|$resourceAmounts$
		@initialResourceAmounts = #$resourceAmounts$
		@tankCost = #$tankCost$|$tankCost$|$tankCost$|$tankCost$|$tankCost$|$tankCost$|$tankCost$|$tankCost$|$tankCost$
		@tankMass = #$tankMass$|$tankMass$|$tankMass$|$tankMass$|$tankMass$|$tankMass$|$tankMass$|$tankMass$|$tankMass$
	}
	@MODULE[USSwitchControl]:HAS[#chemTechUSSwitchControl[true]]
	{
		%ObjectNames = 
		%VariantColors = 
	}
}
@PART[USHydrazineWedge]:NEEDS[UniversalStorage2]:FOR[zzz_ChemicalPropulsion]
{
	@MODULE[USFuelSwitch]:HAS[#chemTechUSFuelSwitch[true]]
	{
		@resourceNames = HTP;HTP;HTP;HTP|Hydrazine;Hydrazine;Hydrazine;Hydrazine|TEATEB;TEATEB;TEATEB;TEATEB
		@resourceAmounts = #$resourceAmounts$|$resourceAmounts$|$resourceAmounts$
		@initialResourceAmounts = #$resourceAmounts$
		@tankCost = #$tankCost$|$tankCost$|$tankCost$
		@tankMass = #$tankMass$|$tankMass$|$tankMass$
	}
	@MODULE[USSwitchControl]:HAS[#chemTechUSSwitchControl[true]]
	{
		%ObjectNames = #LOC_ChemicalCore_HTP_title;#LOC_ChemicalCore_Hydrazine_title;#LOC_ChemicalCore_TEATEB_title
		%VariantColors = #$@ChemicalCoreResourceColors/HTP$,$@ChemicalCoreResourceColors/HTP$;$@ChemicalCoreResourceColors/Hydrazine$,$@ChemicalCoreResourceColors/Hydrazine$;$@ChemicalCoreResourceColors/TEATEB$,$@ChemicalCoreResourceColors/TEATEB$
	}
}
@PART[USPenticore,USHexcore,USOctocore,USAdaptorShroud1250Soyuz]:NEEDS[UniversalStorage2]:FOR[zzz_ChemicalPropulsion]
{
	@MODULE[USFuelSwitch]:HAS[#chemTechUSFuelSwitch[true]]
	{
		@resourceNames = Structural;Structural;Structural;Structural|Kerosene,LqdOxygen;Kerosene,LqdOxygen;Kerosene,LqdOxygen;Kerosene,LqdOxygen|LqdHydrogen,LqdOxygen;LqdHydrogen,LqdOxygen;LqdHydrogen,LqdOxygen;LqdHydrogen,LqdOxygen|Hydrazine,NTO;Hydrazine,NTO;Hydrazine,NTO;Hydrazine,NTO|Kerosene;Kerosene;Kerosene;Kerosene|HTP;HTP;HTP;HTP|Hydrazine;Hydrazine;Hydrazine;Hydrazine|LqdHydrogen;LqdHydrogen;LqdHydrogen;LqdHydrogen|LqdOxygen;LqdOxygen;LqdOxygen;LqdOxygen|NTO;NTO;NTO;NTO
		@resourceAmounts = #0;0;0;0|$resourceAmountsKeroseneLqdOxygen$|$resourceAmountsLqdHydrogenLqdOxygen$|$resourceAmountsHydrazineNTO$|$resourceAmounts$|$resourceAmounts$|$resourceAmounts$|$resourceAmounts$|$resourceAmounts$|$resourceAmounts$
		@tankCost = #$tankCost$|$tankCost$|$tankCost$|$tankCost$|$tankCost$|$tankCost$|$tankCost$|$tankCost$|$tankCost$|$tankCost$
		@tankMass = #$tankMass$|$tankMass$|$tankMass$|$tankMass$|$tankMass$|$tankMass$|$tankMass$|$tankMass$|$tankMass$|$tankMass$
	}
}
@PART[USPenticore,USHexcore,USOctocore]:NEEDS[UniversalStorage2]:FOR[zzz_ChemicalPropulsion]
{
	@MODULE[USSwitchControl]:HAS[#chemTechUSSwitchControl[true]]
	{
		%ObjectNames = #autoLOC_US_CrewTransferTunnel;
		%VariantColors = ##c5c5c5,#c5c5c5;
	}
}
@PART[USAdaptorShroud1250Soyuz]:NEEDS[UniversalStorage2]:FOR[zzz_ChemicalPropulsion]
{
	@MODULE[USSwitchControl]:HAS[#chemTechUSSwitchControl[true]]
	{
		@ObjectNames = Structural;
		@VariantColors = #565656,#565656;
	}
}
@PART[USCylindricalShroud1500,USCylindricalShroud1500ResizedTo1875-2]:NEEDS[UniversalStorage2]:FOR[zzz_ChemicalPropulsion]
{
	@MODULE[USFuelSwitch]:HAS[#chemTechUSFuelSwitch[true]]
	{
		@resourceNames = Structural;Structural;Structural;Structural;Bulkhead|Kerosene,LqdOxygen;Kerosene,LqdOxygen;Kerosene,LqdOxygen;Kerosene,LqdOxygen;Kerosene,LqdOxygen|LqdHydrogen,LqdOxygen;LqdHydrogen,LqdOxygen;LqdHydrogen,LqdOxygen;LqdHydrogen,LqdOxygen;LqdHydrogen,LqdOxygen|Hydrazine,NTO;Hydrazine,NTO;Hydrazine,NTO;Hydrazine,NTO;Hydrazine,NTO|Kerosene;Kerosene;Kerosene;Kerosene;Kerosene|HTP;HTP;HTP;HTP;HTP|Hydrazine;Hydrazine;Hydrazine;Hydrazine;Hydrazine|LqdHydrogen;LqdHydrogen;LqdHydrogen;LqdHydrogen;LqdHydrogen|LqdOxygen;LqdOxygen;LqdOxygen;LqdOxygen;LqdOxygen|NTO;NTO;NTO;NTO;NTO
		@resourceAmounts = #0;0;0;0;0|$resourceAmountsKeroseneLqdOxygen$|$resourceAmountsLqdHydrogenLqdOxygen$|$resourceAmountsHydrazineNTO$|$resourceAmounts$|$resourceAmounts$|$resourceAmounts$|$resourceAmounts$|$resourceAmounts$|$resourceAmounts$
		@initialResourceAmounts = #$resourceAmounts$
		@tankCost = #$tankCost$|$tankCost$|$tankCost$|$tankCost$|$tankCost$|$tankCost$|$tankCost$|$tankCost$|$tankCost$|$tankCost$
		@tankMass = #$tankMass$|$tankMass$|$tankMass$|$tankMass$|$tankMass$|$tankMass$|$tankMass$|$tankMass$|$tankMass$|$tankMass$
	}
	@MODULE[USSwitchControl]:HAS[#chemTechUSSwitchControl[true]]
	{
		@ObjectNames = Structural;
		@VariantColors = #565656,#565656;
	}
}
@PART[USAdaptorShroud1250Vostok]:NEEDS[UniversalStorage2]:FOR[zzz_ChemicalPropulsion]
{
	@MODULE[USFuelSwitch]:HAS[#chemTechUSFuelSwitch[true]]
	{
		@resourceNames = HTP;Structural|HTP;Structural|HTP,Kerosene,LqdOxygen;Structural,Kerosene,LqdOxygen|HTP,LqdHydrogen,LqdOxygen;Structural,LqdHydrogen,LqdOxygen|HTP,Hydrazine,NTO;Structural,Hydrazine,NTO|HTP,Kerosene;Structural,Kerosene|HTP;Structural,HTP|HTP,Hydrazine;Structural,Hydrazine|HTP,LqdHydrogen;Structural,LqdHydrogen|HTP,LqdOxygen;Structural,LqdOxygen|HTP,NTO;Structural,NTO
		@resourceAmounts = 160;0|160;0|160,60,100;0,60,100|160,120,40;0,120,40|160,70,90;0,70,90|160,160;0,160|320;0,160|160,160;0,160|160,160;0,160|160,160;0,160|160,160;0,160
		@initialResourceAmounts = #$resourceAmounts$
		@tankCost = 138;0|138;100|209;72|209;72|209;72|209;72|209;72|209;72|209;72|209;72|209;72
		@tankMass = 0.046;0.000|0.046;0.015|0.064;0.018|0.064;0.018|0.064;0.018|0.064;0.018|0.064;0.018|0.064;0.018|0.064;0.018|0.064;0.018|0.064;0.018
	}
	@MODULE[USSwitchControl]:HAS[#chemTechUSSwitchControl[true]]
	{
		@ObjectNames = Structural;Radiator;
		@VariantColors = #565656,#565656;#eeeeee,#565656;
	}
}

// Add resource names and colours to switches
@PART[USRadialTanks,USAerozineWedge,USPenticore,USHexcore,USOctocore,USAdaptorShroud1250Soyuz,USAdaptorShroud1250Vostok,USCylindricalShroud1500,USCylindricalShroud1500ResizedTo1875-2]:NEEDS[UniversalStorage2]:FOR[zzz_ChemicalPropulsion]
{
	@MODULE[USSwitchControl]:HAS[#chemTechUSSwitchControl[true]]
	{
		@ObjectNames = #$ObjectNames$#LOC_ChemicalPropulsion_propellant_Kerosene_LqdOxygen_title;#LOC_ChemicalPropulsion_propellant_LqdHydrogen_LqdOxygen_title;#LOC_ChemicalPropulsion_propellant_Hydrazine_NTO_title;#LOC_ChemicalCore_Kerosene_title;#LOC_ChemicalCore_HTP_title;#LOC_ChemicalCore_Hydrazine_title;#LOC_ChemicalCore_LqdHydrogen_title;#LOC_ChemicalCore_LqdOxygen_title;#LOC_ChemicalCore_NTO_title
		@VariantColors = #$VariantColors$$@ChemicalCoreResourceColors/Kerosene$,$@ChemicalCoreResourceColors/LqdOxygen$;$@ChemicalCoreResourceColors/LqdHydrogen$,$@ChemicalCoreResourceColors/LqdOxygen$;$@ChemicalCoreResourceColors/Hydrazine$,$@ChemicalCoreResourceColors/NTO$;$@ChemicalCoreResourceColors/Kerosene$,$@ChemicalCoreResourceColors/Kerosene$;$@ChemicalCoreResourceColors/HTP$,$@ChemicalCoreResourceColors/HTP$;$@ChemicalCoreResourceColors/Hydrazine$,$@ChemicalCoreResourceColors/Hydrazine$;$@ChemicalCoreResourceColors/LqdHydrogen$,$@ChemicalCoreResourceColors/LqdHydrogen$;$@ChemicalCoreResourceColors/LqdOxygen$,$@ChemicalCoreResourceColors/LqdOxygen$;$@ChemicalCoreResourceColors/NTO$,$@ChemicalCoreResourceColors/NTO$
	}
}

// Add Xenon to structural cores
@PART[USPenticore,USHexcore,USOctocore]:NEEDS[UniversalStorage2]:FOR[zzz_ChemicalPropulsion]
{
	@MODULE[USFuelSwitch]:HAS[#chemTechUSFuelSwitch[true]]
	{
		@resourceNames = #$resourceNames$|XenonGas;XenonGas;XenonGas;XenonGas

		@chemTechUSVolume1 *= 9
		@chemTechUSVolume2 *= 9
		@chemTechUSVolume3 *= 9
		@chemTechUSVolume4 *= 9
		@resourceAmounts = #$resourceAmounts$|$chemTechUSVolume1$;$chemTechUSVolume2$;$chemTechUSVolume3$;$chemTechUSVolume4$
		@initialResourceAmounts = #$resourceAmounts$

		chemTechUSXenonCost = #$chemTechUSVolume1$
		@chemTechUSXenonCost *= 4
		@chemTechUSCost1 += #$chemTechUSXenonCost$
		@chemTechUSCost2 += #$chemTechUSXenonCost$
		@chemTechUSCost2 += #$chemTechUSXenonCost$
		@chemTechUSCost3 += #$chemTechUSXenonCost$
		@chemTechUSCost3 += #$chemTechUSXenonCost$
		@chemTechUSCost3 += #$chemTechUSXenonCost$
		@tankCost = #$tankCost$|$chemTechUSCost1$;$chemTechUSCost2$;$chemTechUSCost3$;$chemTechUSCost4$

		@tankMass = #$tankMass$|$chemTechUSMass1$;$chemTechUSMass2$;$chemTechUSMass3$;$chemTechUSMass4$
	}
	@MODULE[USSwitchControl]:HAS[#chemTechUSSwitchControl[true]]
	{
		@ObjectNames = #$ObjectNames$;#LOC_ChemicalCore_XenonGas_title
		@VariantColors = #$VariantColors$;#a1a1a1,#fffb69
	}
}

// Add propellant tags for CryoTank boiloff and other things
@PART[USRadialTanks,USAerozineWedge,USPenticore,USHexcore,USOctocore,USAdaptorShroud1250Soyuz,USAdaptorShroud1250Vostok,USCylindricalShroud1500,USCylindricalShroud1500ResizedTo1875-2]:NEEDS[UniversalStorage2]:FOR[zzz_ChemicalPropulsion]
{
	chemTechPropellant = Kerosene
	chemTechPropellant = HTP
	chemTechPropellant = Hydrazine
	chemTechPropellant = LqdHydrogen
	chemTechPropellant = LqdOxygen
	chemTechPropellant = NTO
}

// Remove any Ignition modules accidentally added
@PART:HAS[@MODULE[US*Switch*],@MODULE[ModuleIgnition*]]:NEEDS[ProceduralParts]:AFTER[zzz_ChemicalPropulsion]
{
	-MODULE[ModuleIgnition*],* {}
	-MODULE[ModuleB9PartSwitch]:HAS[#moduleID[chemTech*Switch]],* {}
}